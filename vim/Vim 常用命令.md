### 宏命令(Macros)

高级一些的编辑器，都会包含宏功能，vim 当然也不能缺少了，在 vim 中使用宏是非常方便的：

| 命令 | 说明                               |
| ---- | ---------------------------------- |
| :qx  | 开始记录宏，并将结果存入寄存器 `x` |
| q    | 退出记录模式                       |
| @x   | b播放记录在 `x` 寄存器中的宏命令   |

当在 `normal` 模式下输入 `:qx` 后，你对文本的所有编辑动作将会被记录下来，再次输入 `q` 即退出记录模式，然后输入 `@x` 对刚才记录下来的命令进行重复，此命令后跟数字，表示要重复多少次，比如 `@20` ，可以重复 20 次。这个在文本的批处理中是非常有用的。

> 宏，是一种批量批处理的称谓。一般来说，宏是一种规则或模式，或称语法替换



***

### 同时编辑多个文件

在 `vim` 众多的插件中，有一个叫 `minibuffer` 的插件，就是下面所说的标签页功能了，可以支持同时编辑多个文件。

#### 标签命令

| 命令      | 说明                                    |
| --------- | --------------------------------------- |
| :tabe fn  | 在一个新的标签页中编辑文件 `fn`         |
| gt        | 切换到下一个标签页                      |
| gT        | 切换到上一个标签页                      |
| :tabr     | 切换到第一个标签页                      |
| :tabl     | 切换到最后一个标签页                    |
| :tabm [N] | 把当前 `tab` 移动到第 `N` 个 `tab` 之后 |

#### 窗口命令

| 命令     | 说明                                                       |
| -------- | ---------------------------------------------------------- |
| ctrl+w s | 水平分割窗口                                               |
| ctrl+w w | 切换窗口                                                   |
| ctrl+w q | 退出当前窗口（由于同时有多个文件，此命令不会影响其他窗口） |
| ctrl+w v | 垂直分割窗口                                               |

#### 其他

`vim` 在保存之前不会对文件做实际的修改，只是加载到缓冲区中，对文件的编辑其实是对缓冲区的编辑，直到 `:w` 才会存入物理文件。

| 命令    | 说明                                 |
| ------- | ------------------------------------ |
| :e file | 把 `file` 加载到缓冲区中             |
| :bn     | 跳转到下一个缓冲区                   |
| :bd     | 删除缓冲区（关闭文件）               |
| :sp fn  | 分割窗口，并将 `fn` 加载到新的窗口中 |



***

### 退出编辑器

| 命令 | 说明                                   |
| ---- | -------------------------------------- |
| :w   | 将缓冲区写入文件，即保存               |
| :wq  | 保存修改并退出                         |
| :x   | 保存修改并退出                         |
| :q   | 退出，如果对缓冲区进行过修改，则会提示 |
| :q!  | 强制退出，放弃修改                     |



***

### 查找替换

| 命令           | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| /pattern       | 向后搜索字符串 `pattern`                                     |
| ?pattern       | 向前搜索字符串 `pattern`                                     |
| n              | 下一个匹配（如果是 `/` 搜索，则是向下的下一个，`?` 搜索则是向上的下一个） |
| N              | 上一个匹配（同上）                                           |
| :%s/old/new/g  | 搜索整个文件，将所有的 `old` 替换成 `new`                    |
| :%s/old/new/gc | 搜索整个文件，将所有的 `old` 替换成 `new` ，每次都要你确认是否替换 |



***

### 复制粘贴

| 命令 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| dd   | 删除光标所在行                                               |
| dw   | 删除一个字 (word)                                            |
| x    | 删除当前字符                                                 |
| X    | 删除前一个字符                                               |
| D    | 删除到行末                                                   |
| yy   | 复制一行，此命令可跟数字，表示复制多行，如 `6yy`，表示从当前行开始复制六行 |
| yw   | 复制一个字                                                   |
| y$   | 复制到行末                                                   |
| p    | 粘贴粘贴板的内容到当前行的下面                               |
| P    | 粘贴粘贴板的内容到当前行的上面                               |
| ]p   | 有缩进的粘贴，`vim` 会自动调节代码的缩进                     |
| "a   | 将内容放入/存入 `a` 寄存器，可以支持多粘贴板                 |

> 比如常用的一个寄存器就是系统寄存器，名称为 `+` 所以从系统粘贴板粘贴到 `vim` 中的命令为 `"+p`， 注意此处的 `+` 不表示操作符，而是一个寄存器。



***

### 移动光标

在 `vim` 中移动光标跟其他的编辑器中有很大的区别，不过一旦学会，就会飞速的在文本中移动了。

| 命令       | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| h, j, k, l | 左，下，上，右                                               |
| ctrl + f   | 下翻一页                                                     |
| ctrl + b   | 上翻一页                                                     |
| %          | 跳到与当前括号匹配的括号出，如当前在 `{` ，则跳到与之匹配的 `}` 处 |
| w          | 跳到下一个字首，按标点或单词分割                             |
| W          | 跳到下一个字首，长跳，如 `end-of-line` 被认为是一个字        |
| e          | 跳到下一个字尾                                               |
| E          | 跳到下一个字尾，长跳                                         |
| b          | 跳到上一个字                                                 |
| B          | 跳到上一个字，长跳                                           |
| 0          | 跳至行首，不管有无缩进，就是跳到第 `0` 个字符                |
| ^          | 跳至行首的第一个字符                                         |
| $          | 跳至行尾                                                     |
| gg         | 跳至文件的第一行                                             |
| gd         | 跳至当前光标所在变量的声明处                                 |
| [N]G       | 跳至第 `N` 行，如 `0G` ，就等价于 `gg` ，`100G` 就是第 `100` 行。没 `N` 就是文件底部 |
| fx         | 在当前行中找到 `x` 字符，找到了就跳转至                      |
| ;          | 重复上一个 `f` 命令，而不用重复输入 `fx`                     |
| tx         | 如 `fx` 类似，但是只是跳转到 `x` 的前一个字符处              |
| Fx         | 跟 `fx` 的方向相反                                           |
| ),(        | 跳转到上/下一个语句                                          |
| *          | 查找光标所在处的单词，向下查找                               |
| #          | 查找光标所在处的单词，向上查找                               |
| `.         | 跳转至上次编辑位置                                           |

#### 在屏幕上移动

| 命令 | 说明                             |
| ---- | -------------------------------- |
| H    | 移动光标到当前屏幕的最上边的一行 |
| M    | 移动光标到当前屏幕上中间的一行   |
| L    | 移动光标到当前屏幕最下边的一行   |

#### 书签

| 命令 | 说明                   |
| ---- | ---------------------- |
| ma   | 把当前位置存成标签 `a` |
| `a      |跳转到标签 `a` 处|



***

### 编辑

| 命令     | 说明                                                       |
| -------- | ---------------------------------------------------------- |
| r        | 替换一个字符                                               |
| J        | 将下一行和当前行连接为一行                                 |
| cc       | 删除当前行并进入编辑模式                                   |
| cw       | 删除当前字，并进入编辑模式                                 |
| c$       | 删除从当前位置至行末的内容，并进入编辑模式                 |
| s        | 删除当前字符并进入编辑模式                                 |
| S        | 删除光标所在行并进入编辑模式                               |
| xp       | 交换当前字符和下一个字符                                   |
| u        | 撤销                                                       |
| ctrl + r | 重做                                                       |
| .        | 重复上一个编辑命令                                         |
| ~        | 切换大小写，当前字符                                       |
| g~iw     | 切换当前字的大小写（整个字都变为大写变小写，小写的变大写） |
| gUiw     | 将当前字变成大写（当前字的全部字符）                       |
| guiw     | 将当前字变成小写（当前字的全部字符）                       |
| `>>`     | 将当前行前右移一个单位（tab）                              |
| `<<`     | 将当前行左移一个单位（tab）                                |
| ==       | 自动缩进当前行                                             |



***

### 插入模式

| 命令 | 说明                           |
| ---- | ------------------------------ |
| i    | 从当前字符前进入插入模式       |
| I    | 从光标所在行的行首进入插入模式 |
| a    | 从当前字符后进入插入模式                            |
| A    | 从光标所在行的行末进入插入模式                       |
| o    | 在当前行之下新加一行，并进入插入模式（光标在新加的一行）                               |
| O    | 在当前行之上新加一行，并进入插入模式（光标在新加的一行）                     |
| Esc  | 退出插入模式                               |



***

### 可视模式

#### 标记文本

| 命令     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| v        | 进入可视模式，单字符模式（按`h`, `j`, `k`, `l` 可扩展选中范围） |
| V        | 进入可视模式，行模式（同上）                                 |
| ctrl + v | 进入可视模式，列模式，类似于 `UE` 的列模式（不懂 `UE`）      |
| o        | 跳转光标到选中块的另一个端点（端点：选中块的头字符或尾字符） |
| U        | 将选中块中的内容转成大写                                     |
| ~~O~~    | ~~跳转光标到块的另一个端点~~                                 |
| aw       | 选中一个字（可视模式下）                                     |
| ab       | 选中括号中的所有内容，包括括号本身（同上）                   |
| aB       | 选中 `{}` 的所有内容，包括括号本身（同上）                   |
| ib       | 选中括号中的内容的，不包含括号（同上）                       |
| iB       | 选中 `{}` 中的内容，不包含 `{}` （同上）                     |

#### 对标记进行动作

| 命令 | 说明                       |
| ---- | -------------------------- |
| >    | 选中的块右移（一个 `tab`） |
| <    | 选中的块左移（一个 `tab`） |
| y    | 复制选中块块               |
| d    | 删除（剪切）选中块         |
| ~    | 切换选中块中内容的大小写   |

